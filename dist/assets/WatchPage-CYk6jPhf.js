var e=Object.defineProperty,n=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(n,t,r)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,s=(e,n)=>{for(var t in n||(n={}))a.call(n,t)&&o(e,t,n[t]);if(r)for(var t of r(n))i.call(n,t)&&o(e,t,n[t]);return e},l=(e,r)=>n(e,t(r)),d=(e,n,t)=>o(e,"symbol"!=typeof n?n+"":n,t),c=(e,n,t)=>new Promise(((r,a)=>{var i=e=>{try{s(t.next(e))}catch(n){a(n)}},o=e=>{try{s(t.throw(e))}catch(n){a(n)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,o);s((t=t.apply(e,n)).next())}));import{j as m,S as u,d as p,R as g,C as f}from"./vendor-bootstrap-CDKGkX3Y.js";import{r as h}from"./vendor-react-CSr-5IoM.js";import{d as x}from"./index-B4iOs_t-.js";import{L as v,P as b,f as y,g as w,h as k,V as j,i as E,c as S,j as N,M as z,k as _,U as R,H as P,d as T,D as A,l as M}from"./vendor-ui-rAPUFMbG.js";import{c as C,u as D}from"./vendor-router-D9z9DFGH.js";import"./vendor-redux-DhM9Zidd.js";import"./vendor-query-BOtKDBw2.js";class L{static getPreferences(){try{const e=localStorage.getItem(this.STORAGE_KEYS.USER_PREFERENCES);if(e){const n=JSON.parse(e);return s(s({},this.DEFAULT_PREFERENCES),n)}}catch(e){}return s({},this.DEFAULT_PREFERENCES)}static savePreferences(e){try{const n=this.getPreferences(),t=s(s({},n),e);localStorage.setItem(this.STORAGE_KEYS.USER_PREFERENCES,JSON.stringify(t)),localStorage.setItem(this.STORAGE_KEYS.VOLUME_LEVEL,t.volume.toString()),localStorage.setItem(this.STORAGE_KEYS.MUTED,t.muted.toString()),localStorage.setItem(this.STORAGE_KEYS.PLAYBACK_RATE,t.playbackRate.toString()),localStorage.setItem(this.STORAGE_KEYS.AUTOPLAY,t.autoplay.toString())}catch(n){}}static getVolume(){try{const e=localStorage.getItem(this.STORAGE_KEYS.VOLUME_LEVEL);if(null!==e){const n=parseFloat(e);return isNaN(n)?this.DEFAULT_PREFERENCES.volume:Math.max(0,Math.min(1,n))}}catch(e){}return this.DEFAULT_PREFERENCES.volume}static saveVolume(e){const n=Math.max(0,Math.min(1,e));this.savePreferences({volume:n})}static getMuted(){try{return"true"===localStorage.getItem(this.STORAGE_KEYS.MUTED)}catch(e){}return this.DEFAULT_PREFERENCES.muted}static saveMuted(e){this.savePreferences({muted:e})}static getPlaybackRate(){try{const e=localStorage.getItem(this.STORAGE_KEYS.PLAYBACK_RATE);if(null!==e){const n=parseFloat(e);return isNaN(n)?this.DEFAULT_PREFERENCES.playbackRate:n}}catch(e){}return this.DEFAULT_PREFERENCES.playbackRate}static savePlaybackRate(e){this.savePreferences({playbackRate:e})}static getAutoplay(){try{return"false"!==localStorage.getItem(this.STORAGE_KEYS.AUTOPLAY)}catch(e){}return this.DEFAULT_PREFERENCES.autoplay}static saveAutoplay(e){this.savePreferences({autoplay:e})}static resetPreferences(){try{Object.values(this.STORAGE_KEYS).forEach((e=>{localStorage.removeItem(e)}))}catch(e){}}static exportPreferences(){return JSON.stringify(this.getPreferences(),null,2)}static importPreferences(e){try{const n=JSON.parse(e);return this.savePreferences(n),!0}catch(n){return!1}}}d(L,"STORAGE_KEYS",{USER_PREFERENCES:"ugflix_user_preferences",VOLUME_LEVEL:"ugflix_volume_level",PLAYBACK_RATE:"ugflix_playback_rate",AUTOPLAY:"ugflix_autoplay",MUTED:"ugflix_muted"}),d(L,"DEFAULT_PREFERENCES",{volume:1,muted:!1,playbackRate:1,autoplay:!0,quality:"auto",subtitles:!1,language:"en"});class F{static formatTime(e){const n=Math.floor(e/3600),t=Math.floor(e%3600/60),r=Math.floor(e%60);return n>0?`${n}:${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:`${t}:${r.toString().padStart(2,"0")}`}static calculatePercentage(e,n){return n<=0?0:Math.round(e/n*100)}static isCompleted(e,n){return this.calculatePercentage(e,n)>=90}static canResume(e,n){return e>=120&&!this.isCompleted(e,n)}static createResumeInfo(e){return{canResume:this.canResume(e.progress,e.duration),progress:e.progress,duration:e.duration,percentage:e.percentage,lastWatchedAt:e.last_watched_at,formattedProgress:this.formatTime(e.progress),formattedDuration:this.formatTime(e.duration)}}static getDeviceInfo(){const e=navigator.userAgent;let n="Web";/Android/i.test(e)?n="Android":/iPhone|iPad|iPod/i.test(e)?n="iOS":/Windows/i.test(e)?n="Windows":/Mac/i.test(e)?n="macOS":/Linux/i.test(e)&&(n="Linux");let t="Unknown";e.includes("Chrome")?t="Chrome":e.includes("Firefox")?t="Firefox":e.includes("Safari")?t="Safari":e.includes("Edge")?t="Edge":e.includes("Opera")&&(t="Opera");return{device:`${n}-${t}-${Date.now()}`,platform:n,browser:t}}}const O=[.5,.75,1,1.25,1.5,2],U=({url:e,movieId:n,autoPlay:t=!0,onNext:r,onPrevious:a,onEnded:i,poster:o,relatedMovies:d=[]})=>{const u=h.useRef(null),p=h.useRef(null),g=h.useRef();h.useRef();const f=h.useRef(0),_=h.useRef(0),R=h.useRef(!1);h.useRef();const P=h.useRef(!1),T=h.useRef(!1),A=e=>new Promise((n=>setTimeout(n,e))),M=L.getPreferences(),C=F.getDeviceInfo(),[D,U]=h.useState({playing:!1,currentTime:0,duration:0,volume:M.volume,muted:M.muted,buffering:!0,loaded:0,playbackRate:M.playbackRate,isFullscreen:!1,showControls:!0,ready:!1}),[I,K]=h.useState({canResume:!1,resumePosition:0,showResumeModal:!1,lastSavedProgress:0,progressSaveInterval:5,isSaving:!1,lastSaveTime:0}),[Y,$]=h.useState(!1),[V,G]=h.useState(!1);h.useState({text:"",show:!1});const[B,J]=h.useState({show:!1,value:0}),W=h.useCallback(((e,t,r=!1)=>c(void 0,null,(function*(){if(!n||t<=0||e<=0)return;const a=Date.now();if(!R.current){if(!r){const n=a-f.current,t=Math.abs(e-_.current);if(n<5e3||t<5)return}R.current=!0;try{const r={movie_id:n,progress:Math.floor(e),duration:Math.floor(t),device:C.device,platform:C.platform,browser:C.browser};yield x.saveVideoProgress(r),f.current=a,_.current=e,K((n=>l(s({},n),{lastSavedProgress:e,lastSaveTime:a})))}catch(i){}finally{R.current=!1}}}))),[n,C]),q=h.useCallback((()=>c(void 0,null,(function*(){if(n)try{const e=yield x.getVideoProgress(n);e&&F.canResume(e.progress,e.duration)&&(u.current&&(u.current.currentTime=e.progress),K((e=>l(s({},e),{canResume:!1,resumePosition:0,showResumeModal:!1}))))}catch(e){}}))),[n]),X=e=>{const n=Math.floor(e/3600),t=Math.floor(e%3600/60),r=Math.floor(e%60);return n>0?`${n}:${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:`${t}:${r.toString().padStart(2,"0")}`},H=h.useCallback((()=>{g.current&&clearTimeout(g.current),U((e=>l(s({},e),{showControls:!0}))),D.playing&&(g.current=setTimeout((()=>{U((e=>l(s({},e),{showControls:!1})))}),3e3))}),[D.playing]),Q=h.useCallback((()=>{if(u.current){const e=u.current.currentTime,n=u.current.duration||0;U((t=>l(s({},t),{currentTime:e,duration:n})))}}),[]),Z=()=>{u.current&&(D.playing?u.current.pause():u.current.play().catch(console.error))},ee=()=>{if(u.current){const e=!D.muted;U((n=>l(s({},n),{muted:e}))),u.current.muted=e,L.saveMuted(e)}},ne=e=>{u.current&&(u.current.currentTime=e)},te=()=>{ne(Math.min(D.currentTime+10,D.duration))},re=()=>{ne(Math.max(D.currentTime-10,0))},ae=()=>{!document.fullscreenElement&&p.current?p.current.requestFullscreen().catch(console.error):document.fullscreenElement&&document.exitFullscreen().catch(console.error)},ie=()=>c(void 0,null,(function*(){if(u.current)try{document.pictureInPictureElement?yield document.exitPictureInPicture():yield u.current.requestPictureInPicture()}catch(e){}}));h.useEffect((()=>{const e=e=>{if(e.target===document.body)switch(e.code){case"Space":case"KeyK":e.preventDefault(),Z();break;case"ArrowLeft":case"KeyJ":case"Comma":e.preventDefault(),re();break;case"ArrowRight":case"KeyL":case"Period":e.preventDefault(),te();break;case"ArrowUp":if(e.preventDefault(),u.current){const e=Math.min(1,(u.current.muted?0:D.volume)+.1);u.current.muted=!1,U((n=>l(s({},n),{volume:e,muted:!1}))),u.current.volume=e,L.saveVolume(e),L.saveMuted(!1),J({show:!0,value:Math.round(100*e)}),setTimeout((()=>J((e=>l(s({},e),{show:!1})))),1500)}break;case"ArrowDown":if(e.preventDefault(),u.current){const e=Math.max(0,(u.current.muted?0:D.volume)-.1),n=0===e;U((t=>l(s({},t),{volume:e,muted:n}))),u.current.volume=e,u.current.muted=n,L.saveVolume(e),L.saveMuted(n),J({show:!0,value:Math.round(100*e)}),setTimeout((()=>J((e=>l(s({},e),{show:!1})))),1500)}break;case"KeyM":e.preventDefault(),ee();break;case"KeyF":e.preventDefault(),ae();break;case"KeyP":e.preventDefault(),ie();break;case"KeyS":e.preventDefault(),$((e=>!e));break;case"Slash":e.preventDefault(),G((e=>!e));break;case"Digit0":case"Digit1":case"Digit2":case"Digit3":case"Digit4":case"Digit5":case"Digit6":case"Digit7":case"Digit8":case"Digit9":{const n=parseInt(e.code.replace("Digit",""),10);if(!isNaN(n)&&u.current&&D.duration>0){e.preventDefault();ne((0===n?0:10*n)/100*D.duration)}break}}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[D.playbackRate,D.volume,D.muted]),h.useEffect((()=>{u.current&&(u.current.volume=D.volume,u.current.muted=D.muted,u.current.playbackRate=D.playbackRate)}),[D.volume,D.muted,D.playbackRate]),h.useEffect((()=>{q()}),[q]),h.useEffect((()=>{const e=()=>{if(D.currentTime>0&&D.duration>0){const t={movie_model_id:n,progress:Math.floor(D.currentTime),duration:Math.floor(D.duration),device:C.device,platform:C.platform,browser:C.browser};try{navigator.sendBeacon("/api/video-progress",JSON.stringify(t))}catch(e){}}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[D.playing,D.currentTime,D.duration,n,C,W]);const oe=h.useCallback((()=>c(void 0,null,(function*(){if(!T.current){T.current=!0;try{for(;P.current;){if(u.current&&!u.current.paused&&u.current.duration>0){const e=u.current.currentTime,n=u.current.duration;e>0&&(yield W(e,n))}yield A(5e3)}}finally{T.current=!1}}}))),[W]);h.useEffect((()=>()=>{P.current=!1}),[]),h.useEffect((()=>{const e=()=>{U((e=>l(s({},e),{isFullscreen:!!document.fullscreenElement})))};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)}),[]);const se=D.duration?D.currentTime/D.duration*100:0,le=100*D.loaded;return m.jsxs(m.Fragment,{children:[m.jsxs("div",{ref:p,className:"custom-video-player "+(D.isFullscreen?"fullscreen":""),onMouseMove:()=>{H()},onMouseLeave:()=>U((e=>l(s({},e),{showControls:!1}))),children:[m.jsx("style",{children:"\n        :root {\n          --bg: #0b0b0b;\n          --fg: #eaeaea;\n          --muted: #9aa1a9;\n          --accent: #e50914;\n          --accent-2: #ffffff;\n          --overlay: rgba(0,0,0,0.6);\n          --overlay-2: rgba(0,0,0,0.35);\n          --control-bg: rgba(20,20,20,0.85);\n          --control-hover: #1f1f1f;\n        }\n        .custom-video-player {\n          position: relative;\n          width: 100%;\n          aspect-ratio: 16/9;\n          background: #000;\n          border-radius: 0;\n          overflow: hidden;\n          box-shadow: none;\n          color: var(--fg);\n          user-select: none;\n        }\n        .custom-video-player.fullscreen { position: fixed; inset: 0; width: 100vw; height: 100vh; z-index: 9999; aspect-ratio: unset; }\n        .video-element { width: 100%; height: 100%; object-fit: cover; background: #000; }\n        .loading-overlay { position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:1rem; background: rgba(0,0,0,0.8); color:#fff; z-index:5; }\n        .loading-spinner { animation: spin 1s linear infinite; color: var(--accent); }\n        @keyframes spin { from { transform: rotate(0); } to { transform: rotate(360deg); } }\n\n        .controls-overlay { position:absolute; inset:0; background: linear-gradient(180deg, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0) 20%, rgba(0,0,0,0) 80%, rgba(0,0,0,0.8) 100%); display:flex; flex-direction:column; justify-content:space-between; padding:1rem; transition: opacity .3s ease; z-index:10; }\n        .controls-overlay.show { opacity:1; }\n        .controls-overlay.hide { opacity:0; }\n        .controls-overlay:hover { opacity:1; }\n        .center-play-button { position:absolute; top:50%; left:50%; transform: translate(-50%, -50%); width:80px; height:80px; background: var(--accent); border-radius: 50%; display:flex; align-items:center; justify-content:center; cursor:pointer; transition: all .3s ease; z-index:15; }\n        .center-play-button:hover { background:#b8070f; transform: translate(-50%,-50%) scale(1.1); }\n\n        .progress-container { margin-top:auto; margin-bottom:1rem; }\n        .progress-bar { position:relative; width:100%; height:6px; background: rgba(255,255,255,0.3); border-radius:3px; cursor:pointer; transition: height .2s ease; }\n        .progress-bar:hover { height:8px; }\n        .progress-loaded { position:absolute; top:0; left:0; height:100%; background: rgba(255,255,255,0.5); border-radius:3px; transition: width .3s ease; }\n        .progress-played { position:absolute; top:0; left:0; height:100%; background: var(--accent); border-radius:3px; transition: width .1s ease; }\n        .progress-handle { position:absolute; top:50%; width:14px; height:14px; background: var(--accent); border:2px solid white; border-radius:50%; transform: translateY(-50%); opacity:0; transition: all .2s ease; }\n        .progress-bar:hover .progress-handle { opacity:1; }\n\n        .bottom-controls { display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap; }\n        .controls-left, .controls-right { display:flex; align-items:center; gap:.75rem; flex-wrap:wrap; }\n        .control-btn { background:none; border:none; color:#fff; cursor:pointer; padding:.5rem; display:flex; align-items:center; gap:.25rem; transition: all .2s ease; min-width:36px; min-height:36px; justify-content:center; }\n        .control-btn:hover { background: rgba(255,255,255,0.2); color: var(--accent); }\n        .control-btn:active { transform: scale(0.95); }\n        .skip-text { font-size:10px; font-weight:600; }\n        .volume-control { display:flex; align-items:center; gap:.5rem; }\n        .volume-slider { width:80px; height:4px; background: rgba(255,255,255,0.3); border-radius:2px; outline:none; cursor:pointer; -webkit-appearance:none; }\n        .time-display { color:#fff; font-size:14px; font-weight:500; min-width:100px; text-align:center; }\n        \n        /* Mobile responsive styles */\n        @media (max-width: 768px) {\n          .bottom-controls { gap:0.5rem; padding:0.5rem; }\n          .controls-left, .controls-right { gap:0.4rem; flex:1; justify-content:space-around; }\n          .controls-left { order:1; flex-basis:100%; justify-content:flex-start; }\n          .controls-right { order:2; flex-basis:100%; justify-content:flex-end; }\n          .control-btn { padding:.4rem; min-width:32px; min-height:32px; }\n          .control-btn svg { width:18px; height:18px; }\n          .volume-control { position:relative; }\n          .volume-slider { width:60px; }\n          .time-display { font-size:12px; min-width:80px; order:3; flex-basis:100%; text-align:center; margin-top:0.25rem; }\n          .speed-text { display:none; }\n          .progress-container { margin-bottom:0.5rem; }\n        }\n        \n        @media (max-width: 576px) {\n          .bottom-controls { gap:0.3rem; padding:0.3rem 0.5rem; }\n          .controls-left, .controls-right { gap:0.25rem; }\n          .control-btn { padding:.3rem; min-width:30px; min-height:30px; }\n          .control-btn svg { width:16px; height:16px; }\n          .skip-text { font-size:8px; }\n          .volume-control .volume-slider { display:none; }\n          .time-display { font-size:11px; min-width:70px; }\n          .speed-control { display:flex; }\n          .progress-bar { height:5px; }\n          .progress-bar:hover { height:6px; }\n          .progress-handle { width:12px; height:12px; }\n        }\n        \n        @media (max-width: 400px) {\n          .controls-left { gap:0.15rem; }\n          .controls-right { gap:0.15rem; }\n          .control-btn { padding:.25rem; min-width:28px; min-height:28px; }\n          .control-btn svg { width:14px; height:14px; }\n          .time-display { font-size:10px; min-width:65px; }\n        }\n\n        .speed-control { position:relative; }\n        .speed-text { font-size:12px; font-weight:600; margin-left:.25rem; }\n        .speed-menu { position:absolute; bottom:100%; right:0; background: rgba(0,0,0,0.9); border-radius:8px; padding:.5rem; margin-bottom:.5rem; min-width:80px; backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,0.1); }\n        .speed-option { display:block; width:100%; background:none; border:none; color:#fff; padding:.5rem; cursor:pointer; border-radius:4px; text-align:center; font-size:14px; transition: all .2s ease; }\n        .speed-option:hover { background: rgba(255,255,255,0.1); }\n        .speed-option.active { background: var(--accent); color:#fff; }\n\n\n\n        .help-overlay { position:absolute; top:12px; right:12px; background: rgba(20,20,20,0.9); border:1px solid #222; color:#eaeaea; padding:12px; width: 300px; pointer-events:auto; z-index:25; }\n        .help-overlay h4 { margin:0 0 8px 0; }\n        .help-grid { display:grid; grid-template-columns: auto 1fr; gap:6px 10px; font-size:12px; color:#9aa1a9; }\n\n        .related-wrap { background:#0e0e0e; border-top:1px solid #151515; }\n        .related-title { padding:12px 16px; color:#eaeaea; font-weight:600; font-size:18px; }\n        .related-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:12px; padding:8px 16px 16px; }\n        .related-card { position:relative; height:280px; background:#1a1a1a; border:1px solid #222; overflow:hidden; cursor:pointer; transition: all .3s ease; }\n        .related-card:hover { transform: translateY(-4px); border-color: var(--accent); box-shadow: 0 8px 32px rgba(229,9,20,0.3); }\n        .related-card .bg { position:absolute; inset:0; background-size:cover; background-position:center; filter: brightness(0.8); transition: all .3s ease; }\n        .related-card:hover .bg { filter: brightness(1.1) saturate(1.2); transform: scale(1.05); }\n        .related-card .overlay { position:absolute; inset:0; background: linear-gradient(180deg, rgba(0,0,0,0.0), rgba(0,0,0,0.8)); }\n        .related-card .title { position:absolute; left:12px; right:12px; bottom:12px; color:#fff; font-weight:700; font-size:15px; text-shadow: 0 2px 8px rgba(0,0,0,0.8); line-height:1.3; }\n        .related-card .play-icon { position:absolute; top:50%; left:50%; transform: translate(-50%,-50%); opacity:0; transition: all .3s ease; background: rgba(229,9,20,0.9); border-radius:50%; width:50px; height:50px; display:flex; align-items:center; justify-content:center; }\n        .related-card:hover .play-icon { opacity:1; transform: translate(-50%,-50%) scale(1.1); }\n        \n        .volume-indicator { position:absolute; top:50%; left:50%; transform: translate(-50%,-50%); background: rgba(0,0,0,0.8); color:#fff; padding:12px 20px; border-radius:8px; font-weight:600; font-size:18px; z-index:30; transition: all .3s ease; backdrop-filter: blur(10px); }\n        .volume-indicator.hide { opacity:0; transform: translate(-50%,-50%) scale(0.8); }\n        .volume-indicator.show { opacity:1; transform: translate(-50%,-50%) scale(1); }\n        \n        .tooltip { position:absolute; background: rgba(0,0,0,0.9); color:#fff; padding:6px 10px; font-size:12px; border-radius:4px; white-space:nowrap; z-index:25; pointer-events:none; transition: all .2s ease; }\n        .tooltip.hide { opacity:0; transform: translateY(4px); }\n        .tooltip.show { opacity:1; transform: translateY(0); }\n        \n        .buffer-indicator { position:absolute; top:0; left:0; height:2px; background: var(--accent); z-index:12; transition: width .3s ease; }\n        .mini-timeline { position:absolute; bottom:80px; left:50%; transform: translateX(-50%); background: rgba(0,0,0,0.9); padding:8px; border-radius:4px; font-size:12px; color:#fff; opacity:0; transition: all .2s ease; pointer-events:none; }\n        .progress-bar:hover + .mini-timeline { opacity:1; }\n        "}),m.jsx("video",{ref:u,src:e,poster:o,onLoadStart:()=>{U((e=>l(s({},e),{buffering:!0,ready:!1})))},onCanPlay:()=>{U((e=>l(s({},e),{buffering:!1,ready:!0}))),t&&u.current&&u.current.play().catch(console.error)},onTimeUpdate:Q,onProgress:()=>{if(u.current&&u.current.buffered.length>0){const e=u.current.buffered.end(0)/u.current.duration;U((n=>l(s({},n),{loaded:e})))}},onWaiting:()=>{U((e=>l(s({},e),{buffering:!0})))},onPlaying:()=>{U((e=>l(s({},e),{buffering:!1,playing:!0}))),P.current=!0,T.current||oe(),H()},onPause:()=>{U((e=>l(s({},e),{playing:!1}))),P.current=!1},onEnded:i,className:"video-element",preload:"metadata",onDoubleClick:ae,onClick:Z}),D.buffering&&m.jsxs("div",{className:"loading-overlay",children:[m.jsx(v,{className:"loading-spinner",size:48}),m.jsx("span",{children:"Loading..."})]}),m.jsxs("div",{className:"controls-overlay "+(D.showControls?"show":"hide"),children:[!D.playing&&D.ready&&m.jsx("div",{className:"center-play-button",onClick:Z,children:m.jsx(b,{size:64,fill:"white"})}),m.jsx("div",{className:"progress-container",children:m.jsxs("div",{className:"progress-bar",onClick:e=>{const n=e.currentTarget.getBoundingClientRect(),t=(e.clientX-n.left)/n.width*D.duration;ne(t)},children:[m.jsx("div",{className:"progress-loaded",style:{width:`${le}%`}}),m.jsx("div",{className:"progress-played",style:{width:`${se}%`}}),m.jsx("div",{className:"progress-handle",style:{left:`${se}%`}})]})}),m.jsxs("div",{className:"bottom-controls",children:[m.jsxs("div",{className:"controls-left",children:[m.jsx("button",{className:"control-btn",onClick:Z,children:D.playing?m.jsx(y,{size:24}):m.jsx(b,{size:24})}),a&&m.jsx("button",{className:"control-btn",onClick:a,children:m.jsx(w,{size:20})}),m.jsxs("button",{className:"control-btn",onClick:re,children:[m.jsx(w,{size:16}),m.jsx("span",{className:"skip-text",children:"10"})]}),m.jsxs("button",{className:"control-btn",onClick:te,children:[m.jsx("span",{className:"skip-text",children:"10"}),m.jsx(k,{size:16})]}),r&&m.jsx("button",{className:"control-btn",onClick:r,children:m.jsx(k,{size:20})}),m.jsxs("div",{className:"volume-control",children:[m.jsx("button",{className:"control-btn",onClick:ee,children:D.muted||0===D.volume?m.jsx(j,{size:20}):m.jsx(E,{size:20})}),m.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:D.muted?0:D.volume,onChange:e=>{const n=parseFloat(e.target.value),t=0===n;U((e=>l(s({},e),{volume:n,muted:t}))),u.current&&(u.current.volume=n,u.current.muted=t),L.saveVolume(n),L.saveMuted(t)},className:"volume-slider"})]}),m.jsxs("div",{className:"time-display",children:[X(D.currentTime)," / ",X(D.duration)]})]}),m.jsxs("div",{className:"controls-right",children:[m.jsxs("div",{className:"speed-control",children:[m.jsxs("button",{className:"control-btn",onClick:()=>$(!Y),children:[m.jsx(S,{size:20}),m.jsxs("span",{className:"speed-text",children:[D.playbackRate,"x"]})]}),Y&&m.jsx("div",{className:"speed-menu",children:O.map((e=>m.jsxs("button",{className:"speed-option "+(e===D.playbackRate?"active":""),onClick:()=>(e=>{U((n=>l(s({},n),{playbackRate:e}))),u.current&&(u.current.playbackRate=e),L.savePlaybackRate(e),$(!1)})(e),children:[e,"x"]},e)))})]}),m.jsx("button",{className:"control-btn",onClick:ie,children:m.jsx(N,{size:20})}),m.jsx("button",{className:"control-btn",onClick:ae,children:m.jsx(z,{size:20})})]})]})]}),B.show&&m.jsxs("div",{className:"volume-indicator "+(B.show?"show":"hide"),children:["🔊 ",B.value,"%"]}),V&&m.jsxs("div",{className:"help-overlay",children:[m.jsx("h4",{children:"⌨️ Keyboard shortcuts"}),m.jsxs("div",{className:"help-grid",children:[m.jsx("span",{children:"Space / K"}),m.jsx("span",{children:"Play/Pause"}),m.jsx("span",{children:"J / Left"}),m.jsx("span",{children:"Back 10s"}),m.jsx("span",{children:"L / Right"}),m.jsx("span",{children:"Forward 10s"}),m.jsx("span",{children:"< / >"}),m.jsx("span",{children:"Seek ±10s"}),m.jsx("span",{children:"Up / Down"}),m.jsx("span",{children:"Volume +/-"}),m.jsx("span",{children:"M"}),m.jsx("span",{children:"Mute/Unmute"}),m.jsx("span",{children:"F"}),m.jsx("span",{children:"Fullscreen"}),m.jsx("span",{children:"P"}),m.jsx("span",{children:"Picture-in-Picture"}),m.jsx("span",{children:"S"}),m.jsx("span",{children:"Speed menu"}),m.jsx("span",{children:"0-9"}),m.jsx("span",{children:"Seek to %"}),m.jsx("span",{children:"?"}),m.jsx("span",{children:"Toggle help"})]})]})]}),d.length>0&&m.jsxs("div",{className:"related-wrap",children:[m.jsx("div",{className:"related-title",children:"Related"}),m.jsx("div",{className:"related-grid",children:d.map((e=>m.jsxs("div",{className:"related-card",onClick:()=>{},children:[m.jsx("div",{className:"bg",style:{backgroundImage:`url(${e.image})`}}),m.jsx("div",{className:"overlay"}),m.jsx("div",{className:"play-icon",children:m.jsx(b,{size:20,fill:"white"})}),m.jsx("div",{className:"title",children:e.title})]},e.id)))})]})]})},I=()=>{const{id:e}=C(),n=D(),[t,r]=h.useState(null),[a,i]=h.useState(!0),[o,s]=h.useState(null),[l,d]=h.useState(0),[v,y]=h.useState(!1),[w,k]=h.useState(!0);h.useEffect((()=>{const e=document.createElement("style");return e.innerHTML="\n  .watch-page {\n    background: var(--ugflix-bg-primary);\n    color: var(--ugflix-text-primary);\n    min-height: 100vh;\n    padding-top: 0 !important;\n    margin-top: 0 !important;\n    padding-bottom: 80px;\n  }\n\n  .watch-container {\n    padding: 0 !important;\n    max-width: var(--ugflix-max-width);\n    margin: 0 auto;\n  }\n\n  .watch-page .row {\n    margin: 0;\n    --bs-gutter-x: 0;\n  }\n\n  .share-toast {\n    position: fixed;\n    top: calc(var(--ugflix-header-height) + 5px);\n    right: 20px;\n    background: var(--ugflix-primary);\n    color: var(--ugflix-text-primary);\n    padding: 12px 20px;\n    border-radius: var(--ugflix-border-radius);\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    font-size: 13px;\n    font-weight: 500;\n    box-shadow: var(--ugflix-shadow);\n    z-index: 9999;\n    animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;\n  }\n\n  @keyframes slideIn {\n    from { transform: translateX(100%); opacity: 0; }\n    to { transform: translateX(0); opacity: 1; }\n  }\n\n  @keyframes fadeOut {\n    to { opacity: 0; transform: translateX(100%); }\n  }\n\n  .video-container {\n    position: relative;\n    background: #000;\n    width: 100%;\n    aspect-ratio: 16/9;\n    margin: 0;\n    border-radius: var(--ugflix-border-radius);\n    overflow: hidden;\n  }\n\n  .movie-info-section {\n    background: transparent;\n    padding: 0.5rem 1rem; /* Add horizontal padding for mobile */\n    border-bottom: none;\n  }\n\n  .movie-title {\n    font-size: 1.1rem;\n    font-weight: 600;\n    color: var(--ugflix-text-high-contrast);\n    margin: 0 0 0.75rem 0;\n    line-height: 1.4;\n  }\n\n  .movie-meta-row {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    flex-wrap: wrap;\n    gap: 0.75rem;\n    margin-bottom: 0.75rem;\n    padding-bottom: 0;\n    border-bottom: none;\n  }\n\n  .meta-badges {\n    display: flex;\n    align-items: center;\n    flex-wrap: wrap;\n    gap: 0.4rem;\n  }\n\n  .meta-badge {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.3rem;\n    padding: 0.3rem 0.6rem;\n    border-radius: var(--ugflix-border-radius);\n    font-size: 0.7rem;\n    font-weight: 500;\n    background: transparent;\n    color: var(--ugflix-text-muted);\n    border: 1px solid var(--ugflix-border);\n  }\n\n  .meta-badge svg {\n    width: 12px;\n    height: 12px;\n  }\n\n  .year-badge {\n    background: transparent;\n    color: var(--ugflix-text-muted);\n    border-color: var(--ugflix-border);\n  }\n\n  .rating-badge {\n    background: transparent;\n    color: var(--ugflix-accent);\n    border-color: var(--ugflix-border);\n  }\n\n  .duration-badge {\n    background: transparent;\n    color: var(--ugflix-text-muted);\n    border-color: var(--ugflix-border);\n  }\n\n  .episode-badge {\n    background: transparent;\n    color: var(--ugflix-text-muted);\n    border-color: var(--ugflix-border);\n  }\n\n  .movie-stats {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    flex-wrap: wrap;\n  }\n\n  .stat-item {\n    display: flex;\n    align-items: center;\n    gap: 0.3rem;\n    font-size: 0.7rem;\n    color: var(--ugflix-text-muted);\n    font-weight: 400;\n  }\n\n  .stat-item svg {\n    width: 13px;\n    height: 13px;\n    color: var(--ugflix-text-muted);\n  }\n\n  .genre-tags {\n    display: flex;\n    align-items: center;\n    flex-wrap: wrap;\n    gap: 0.4rem;\n    margin-bottom: 0.75rem;\n  }\n\n  .genre-tag {\n    padding: 0.3rem 0.65rem;\n    border-radius: var(--ugflix-border-radius);\n    font-size: 0.65rem;\n    font-weight: 500;\n    background: transparent;\n    color: var(--ugflix-text-muted);\n    border: 1px solid var(--ugflix-border);\n    transition: var(--ugflix-transition-fast);\n    cursor: pointer;\n    text-transform: uppercase;\n    letter-spacing: 0.3px;\n  }\n\n  .genre-tag:hover {\n    background: var(--ugflix-hover-bg-subtle);\n    border-color: var(--ugflix-primary);\n    color: var(--ugflix-primary);\n  }\n\n  .action-buttons {\n    display: flex;\n    align-items: center;\n    flex-wrap: wrap;\n    gap: 0.4rem;\n    margin: 0;\n    padding: 0;\n    border-bottom: none;\n  }\n\n  .action-btn {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.35rem;\n    padding: 0.4rem 0.75rem;\n    border-radius: var(--ugflix-border-radius);\n    font-size: 0.7rem;\n    font-weight: 500;\n    border: 1px solid var(--ugflix-border);\n    background: transparent;\n    color: var(--ugflix-text-secondary);\n    cursor: pointer;\n    transition: var(--ugflix-transition-fast);\n    text-transform: none;\n    letter-spacing: 0;\n  }\n\n  .action-btn:hover {\n    background: var(--ugflix-hover-bg-subtle);\n    border-color: var(--ugflix-primary);\n    color: var(--ugflix-primary);\n    transform: translateY(-1px);\n  }\n\n  .action-btn:active {\n    transform: translateY(0);\n  }\n\n  .action-btn svg {\n    width: 13px;\n    height: 13px;\n  }\n\n  .like-btn.active {\n    background: var(--ugflix-hover-bg-medium);\n    border-color: var(--ugflix-primary);\n    color: var(--ugflix-primary);\n  }\n\n  .watchlist-btn.active {\n    background: var(--ugflix-accent-hover-bg);\n    border-color: var(--ugflix-accent);\n    color: var(--ugflix-accent);\n  }\n\n  .share-btn:hover {\n    background: rgba(59, 130, 246, 0.1);\n    border-color: #3b82f6;\n    color: #3b82f6;\n  }\n\n  .download-btn:hover {\n    background: rgba(76, 175, 80, 0.1);\n    border-color: var(--ugflix-text-success);\n    color: var(--ugflix-text-success);\n  }\n\n  .movie-description {\n    margin-bottom: 0.75rem;\n  }\n\n  .section-title {\n    font-size: 0.75rem;\n    font-weight: 600;\n    color: var(--ugflix-text-secondary);\n    margin: 0 0 0.4rem 0;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .movie-description p {\n    font-size: 0.85rem;\n    line-height: 1.6;\n    color: var(--ugflix-text-secondary);\n    margin: 0;\n  }\n\n  .movie-details {\n    display: flex;\n    flex-direction: column;\n    gap: 0.4rem;\n  }\n\n  .detail-row {\n    display: flex;\n    align-items: flex-start;\n    gap: 0.6rem;\n    font-size: 0.8rem;\n  }\n\n  .detail-label {\n    font-weight: 500;\n    color: var(--ugflix-text-muted);\n    min-width: 65px;\n    font-size: 0.75rem;\n  }\n\n  .detail-value {\n    color: var(--ugflix-text-secondary);\n    flex: 1;\n    font-size: 0.8rem;\n  }\n\n  .related-movies-sidebar {\n    background: transparent;\n    padding: 0 1rem; /* Add horizontal padding to prevent touching screen borders */\n    height: 100%;\n  }\n\n  .sidebar-title {\n    font-size: 0.85rem;\n    font-weight: 600;\n    color: var(--ugflix-text-high-contrast);\n    margin: 0 0 0.75rem 0;\n    padding-bottom: 0.5rem;\n    border-bottom: 1px solid var(--ugflix-primary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .related-movies-list {\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n    max-height: calc(100vh - 140px);\n    overflow-y: auto;\n    padding-right: 0.5rem;\n  }\n\n  .related-movies-list::-webkit-scrollbar {\n    width: 5px;\n  }\n\n  .related-movies-list::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  .related-movies-list::-webkit-scrollbar-thumb {\n    background: var(--ugflix-primary);\n    border-radius: 10px;\n  }\n\n  .related-movies-list::-webkit-scrollbar-thumb:hover {\n    background: var(--ugflix-primary-light);\n  }\n\n  .related-movie-card {\n    display: flex;\n    gap: 1rem;\n    cursor: pointer;\n    transition: var(--ugflix-transition-fast);\n    border-radius: var(--ugflix-border-radius);\n    overflow: hidden;\n    background: transparent;\n    border: 1px solid var(--ugflix-border);\n    padding: 0.75rem;\n    position: relative;\n    min-height: 120px;\n  }\n\n  .related-movie-card.next-episode {\n    border: 2px solid var(--ugflix-primary);\n    background: rgba(183, 28, 28, 0.08);\n    box-shadow: 0 0 20px rgba(183, 28, 28, 0.3);\n  }\n\n  .related-movie-card.next-episode::before {\n    opacity: 1;\n    width: 5px;\n  }\n\n  .related-movie-card.next-episode .next-badge {\n    display: flex;\n  }\n\n  .related-movie-card:hover {\n    border-color: var(--ugflix-primary);\n    background: var(--ugflix-hover-bg-subtle);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  }\n\n  .related-movie-card::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 4px;\n    background: var(--ugflix-primary);\n    opacity: 0;\n    transition: var(--ugflix-transition-fast);\n  }\n\n  .related-movie-card:hover::before {\n    opacity: 1;\n  }\n\n  .related-movie-thumbnail {\n    position: relative;\n    width: 160px;\n    min-width: 160px;\n    height: 90px;\n    background: #000;\n    overflow: hidden;\n    border-radius: var(--ugflix-border-radius);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n  }\n\n  .related-movie-thumbnail img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n    transition: var(--ugflix-transition);\n  }\n\n  .related-movie-card:hover .related-movie-thumbnail img {\n    transform: scale(1.1);\n    filter: brightness(1.1);\n  }\n\n  .play-overlay-icon {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 40px;\n    height: 40px;\n    background: rgba(183, 28, 28, 0.95);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    transition: var(--ugflix-transition-fast);\n    backdrop-filter: blur(10px);\n    border: 2px solid rgba(255, 255, 255, 0.4);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n  }\n\n  .play-overlay-icon svg {\n    margin-left: 2px;\n  }\n\n  .related-movie-card:hover .play-overlay-icon {\n    opacity: 1;\n    transform: translate(-50%, -50%) scale(1.15);\n  }\n\n  .related-movie-info {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    padding: 0.35rem 0;\n    min-width: 0;\n  }\n\n  .related-movie-title {\n    font-size: 0.85rem;\n    font-weight: 600;\n    color: var(--ugflix-text-high-contrast);\n    margin: 0 0 0.5rem 0;\n    line-height: 1.4;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    word-wrap: break-word;\n    word-break: break-word;\n    hyphens: auto;\n    transition: var(--ugflix-transition-fast);\n  }\n\n  .related-movie-card:hover .related-movie-title {\n    color: var(--ugflix-primary);\n  }\n\n  .related-movie-meta {\n    display: flex;\n    align-items: center;\n    gap: 0.6rem;\n    font-size: 0.7rem;\n    flex-wrap: wrap;\n  }\n\n  .meta-type {\n    padding: 0.3rem 0.6rem;\n    border-radius: var(--ugflix-border-radius);\n    background: rgba(183, 28, 28, 0.15);\n    color: var(--ugflix-primary);\n    font-weight: 600;\n    border: 1px solid var(--ugflix-primary);\n    font-size: 0.65rem;\n    text-transform: uppercase;\n  }\n\n  .meta-vj {\n    padding: 0.3rem 0.6rem;\n    border-radius: var(--ugflix-border-radius);\n    background: transparent;\n    color: var(--ugflix-text-muted);\n    font-weight: 500;\n    border: 1px solid var(--ugflix-border);\n    font-size: 0.65rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 120px;\n  }\n\n  .meta-episode {\n    padding: 0.3rem 0.6rem;\n    border-radius: var(--ugflix-border-radius);\n    background: var(--ugflix-primary);\n    color: var(--ugflix-text-primary);\n    font-weight: 600;\n    font-size: 0.7rem;\n  }\n\n  .meta-rating {\n    display: flex;\n    align-items: center;\n    gap: 0.3rem;\n    color: var(--ugflix-accent);\n    font-weight: 600;\n    font-size: 0.7rem;\n  }\n\n  .meta-rating svg {\n    width: 12px;\n    height: 12px;\n  }\n\n  .meta-duration {\n    display: flex;\n    align-items: center;\n    gap: 0.3rem;\n    color: var(--ugflix-text-muted);\n    font-size: 0.7rem;\n  }\n\n  .meta-duration svg {\n    width: 12px;\n    height: 12px;\n  }\n\n  .next-badge {\n    display: none;\n    position: absolute;\n    top: 0.5rem;\n    right: 0.5rem;\n    padding: 0.35rem 0.7rem;\n    border-radius: var(--ugflix-border-radius);\n    background: var(--ugflix-primary);\n    color: var(--ugflix-text-primary);\n    font-size: 0.65rem;\n    font-weight: 700;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    z-index: 2;\n    box-shadow: 0 2px 8px rgba(183, 28, 28, 0.5);\n    animation: pulse 2s infinite;\n  }\n\n  @keyframes pulse {\n    0%, 100% { transform: scale(1); }\n    50% { transform: scale(1.05); }\n  }\n\n  .no-related {\n    text-align: center;\n    padding: 2rem 1rem;\n    color: var(--ugflix-text-muted);\n    font-size: 0.85rem;\n  }\n\n  .watch-page-loading {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    min-height: 70vh;\n    gap: 1.5rem;\n  }\n\n  .loading-text {\n    font-size: 1rem;\n    font-weight: 500;\n    color: var(--ugflix-text-secondary);\n  }\n\n  .watch-page-error {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    min-height: 70vh;\n    text-align: center;\n    padding: 2rem;\n  }\n\n  .watch-page-error h2 {\n    font-size: 1.8rem;\n    margin-bottom: 1rem;\n    color: var(--ugflix-primary);\n  }\n\n  .watch-page-error p {\n    font-size: 0.95rem;\n    color: var(--ugflix-text-muted);\n    margin-bottom: 2rem;\n    max-width: 500px;\n  }\n\n  .back-btn {\n    background: var(--ugflix-primary);\n    border: none;\n    color: var(--ugflix-text-primary);\n    padding: 0.875rem 2rem;\n    border-radius: var(--ugflix-border-radius);\n    font-size: 0.9rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: var(--ugflix-transition-fast);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .back-btn:hover {\n    background: var(--ugflix-primary-light);\n    transform: translateY(-2px);\n    box-shadow: var(--ugflix-shadow-hover);\n  }\n\n  .left-content,\n  .right-content {\n    padding: 0;\n  }\n\n  @media (max-width: 575px) {\n    .related-movie-card {\n      min-height: 100px;\n      padding: 0.6rem;\n      gap: 0.75rem;\n    }\n\n    .related-movie-thumbnail {\n      width: 130px;\n      min-width: 130px;\n      height: 73px;\n    }\n\n    .related-movie-title {\n      font-size: 0.8rem;\n      margin: 0 0 0.4rem 0;\n    }\n\n    .related-movie-meta {\n      gap: 0.4rem;\n    }\n\n    .meta-type,\n    .meta-vj,\n    .meta-episode,\n    .meta-rating,\n    .meta-duration {\n      font-size: 0.6rem;\n      padding: 0.25rem 0.5rem;\n    }\n\n    .next-badge {\n      font-size: 0.6rem;\n      padding: 0.3rem 0.6rem;\n      top: 0.4rem;\n      right: 0.4rem;\n    }\n\n    .play-overlay-icon {\n      width: 35px;\n      height: 35px;\n    }\n  }\n\n  @media (min-width: 576px) {\n    .movie-info-section {\n      padding: 0.5rem 1.5rem; /* Increase padding on small tablets */\n    }\n    \n    .movie-title {\n      font-size: 1rem;\n    }\n\n    .related-movies-sidebar {\n      padding: 0 1.5rem; /* Increase padding on slightly larger screens */\n    }\n\n    .related-movie-card {\n      min-height: 120px;\n    }\n  }\n\n  @media (min-width: 768px) {\n    .movie-info-section {\n      padding: 1rem 1.5rem; /* Maintain comfortable padding on tablets */\n    }\n    \n    .movie-title {\n      font-size: 1.2rem;\n    }\n    \n    .meta-badge {\n      font-size: 0.75rem;\n      padding: 0.35rem 0.7rem;\n    }\n    \n    .stat-item {\n      font-size: 0.75rem;\n    }\n    \n    .action-btn {\n      font-size: 0.75rem;\n      padding: 0.45rem 0.85rem;\n    }\n    \n    .genre-tag {\n      font-size: 0.7rem;\n      padding: 0.35rem 0.75rem;\n    }\n    \n    .movie-description p {\n      font-size: 0.9rem;\n      line-height: 1.7;\n    }\n    \n    .detail-row {\n      font-size: 0.85rem;\n    }\n    \n    .sidebar-title {\n      font-size: 0.9rem;\n    }\n    \n    .related-movie-title {\n      font-size: 0.85rem;\n    }\n\n    .related-movie-card {\n      min-height: 125px;\n    }\n\n    .related-movie-thumbnail {\n      width: 170px;\n      min-width: 170px;\n      height: 95px;\n    }\n  }\n\n  @media (min-width: 992px) {\n    .watch-container {\n      padding: 0 0rem !important;\n    }\n    \n    .left-content {\n      padding-right: 0.75rem !important;\n    }\n    \n    .right-content {\n      padding-left: 0.75rem !important;\n    }\n    \n    .movie-info-section {\n      padding: 1rem 1.5rem;\n    }\n    \n    .movie-title {\n      font-size: 1.25rem;\n    }\n    \n    .related-movies-sidebar {\n      position: sticky;\n      top: 0;\n      padding: 0 1.5rem; /* Keep padding on desktop to maintain consistent spacing */\n      max-height: 100vh;\n      overflow: hidden;\n    }\n    \n    .related-movies-list {\n      max-height: calc(100vh - 100px);\n    }\n\n    .related-movie-card {\n      min-height: 130px;\n    }\n  }\n\n  @media (min-width: 1200px) {\n    .watch-container {\n      padding: 0 0rem !important;\n    }\n    \n    .movie-info-section {\n      padding: 1rem 2rem; /* Larger padding on desktop */\n    }\n    \n    .movie-title {\n      font-size: 1.3rem;\n    }\n    \n    .sidebar-title {\n      font-size: 0.95rem;\n    }\n  }\n\n    @media (min-width: 1400px) {\n    .movie-info-section {\n      padding: 1.5rem 3rem; /* Maximum padding on large screens */\n    }\n",document.head.appendChild(e),()=>{document.head.removeChild(e)}}),[]);const j=h.useCallback((()=>{const e=document.documentElement.scrollHeight,n=window.innerHeight;y(e>n)}),[]);h.useEffect((()=>{e&&E(e)}),[e]),h.useEffect((()=>{if(t){const e=setTimeout(j,100);return()=>clearTimeout(e)}}),[t,j]),h.useEffect((()=>(window.addEventListener("resize",j),()=>window.removeEventListener("resize",j))),[j]),h.useEffect((()=>{const e=e=>{const n=document.querySelector("video");if(n)switch(e.key.toLowerCase()){case" ":case"k":e.preventDefault(),n.paused?n.play():n.pause();break;case"arrowleft":case"j":e.preventDefault(),n.currentTime=Math.max(0,n.currentTime-10);break;case"arrowright":case"l":e.preventDefault(),n.currentTime=Math.min(n.duration,n.currentTime+10);break;case"arrowup":e.preventDefault(),n.volume=Math.min(1,n.volume+.1);break;case"arrowdown":e.preventDefault(),n.volume=Math.max(0,n.volume-.1);break;case"m":e.preventDefault(),n.muted=!n.muted;break;case"f":e.preventDefault(),document.fullscreenElement?document.exitFullscreen():n.requestFullscreen();break;case"n":e.preventDefault(),F()&&z();break;case"p":e.preventDefault(),O()&&L()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[t,l]);const E=e=>c(void 0,null,(function*(){try{i(!0),s(null);const n=yield x.getMovieById(e);n.related_movies&&!Array.isArray(n.related_movies)&&(n.related_movies=Object.values(n.related_movies)),n.related_movies||(n.related_movies=[]),r(n)}catch(n){s(n instanceof Error?n.message:"An error occurred loading the movie")}finally{i(!1)}})),S=()=>t?t.movie:null,N=()=>{if(!t||"Series"!==t.movie.type)return null;if(!Array.isArray(t.related_movies)||0===t.related_movies.length)return null;const e=t.movie.episode_number||0,n=t.related_movies.find((n=>"Series"===n.type&&n.category===t.movie.category&&n.episode_number===e+1));if(n)return n;return t.related_movies.filter((e=>"Series"===e.type&&e.category===t.movie.category)).sort(((e,n)=>(e.episode_number||0)-(n.episode_number||0))).find((n=>(n.episode_number||0)>e))||null},z=()=>{if(t){if("Series"===t.movie.type){const e=N();if(e)return k(!0),void n(`/watch/${e.id}`)}if(Array.isArray(t.related_movies)&&t.related_movies.length>0){const e=t.related_movies[0];k(!0),n(`/watch/${e.id}`)}}},L=()=>{if(!t||"Series"!==t.movie.type)return;if(!Array.isArray(t.related_movies))return;const e=t.related_movies.filter((e=>"Series"===e.type&&e.category===t.movie.category));if(l>0){const t=e[l-1];n(`/watch/${t.id}`)}},F=()=>{if(!t||!Array.isArray(t.related_movies))return!1;if("Series"===t.movie.type){const e=t.related_movies.filter((e=>"Series"===e.type&&e.category===t.movie.category));if(l<e.length-1)return!0}return t.related_movies.length>0},O=()=>!(!t||"Series"!==t.movie.type)&&(!!Array.isArray(t.related_movies)&&l>0),[I,K]=h.useState(!1),[Y,$]=h.useState(0),[V,G]=h.useState(!1),[B,J]=h.useState(!1),[W,q]=h.useState(0),[X,H]=h.useState(!1),[Q,Z]=h.useState(!1);h.useEffect((()=>{t&&(K(t.user_interactions.has_liked),$(t.movie.likes_count||0),J(t.user_interactions.has_wishlisted||!1),q(t.movie.wishlist_count||0))}),[t]);const ee=e=>e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString();if(a)return m.jsxs("div",{className:"watch-page-loading",children:[m.jsx(u,{animation:"border",variant:"warning"}),m.jsx("div",{className:"loading-text",children:"Loading movie..."})]});if(o||!t)return m.jsxs("div",{className:"watch-page-error",children:[m.jsx("h2",{children:o?"Error Loading Movie":"Movie Not Found"}),m.jsx("p",{children:o||"The movie you're looking for doesn't exist."}),m.jsx("button",{onClick:()=>n(-1),className:"back-btn",children:"Go Back"})]});const ne=S();return ne?m.jsx("div",{className:"watch-page "+(v?"has-overflow":"no-overflow"),children:m.jsxs(p,{fluid:!0,className:"watch-container",children:[Q&&m.jsxs("div",{className:"share-toast",children:[m.jsx(_,{size:18}),"Link copied to clipboard!"]}),m.jsxs(g,{className:"g-3 g-md-4",children:[m.jsxs(f,{lg:8,className:"left-content",children:[m.jsx("div",{className:"video-container",children:m.jsx(U,{url:ne.url,movieId:ne.id,poster:ne.thumbnail_url,autoPlay:w,onNext:F()?z:void 0,onPrevious:O()?L:void 0,onEnded:F()?z:void 0})}),m.jsxs("div",{className:"movie-info-section",children:[m.jsx("h1",{className:"movie-title",children:ne.title}),m.jsxs("div",{className:"movie-meta-row",children:[m.jsxs("div",{className:"meta-badges",children:["Series"===ne.type&&ne.episode_number&&m.jsxs("span",{className:"meta-badge episode-badge",children:["Ep ",ne.episode_number]}),m.jsxs("span",{className:"stat-item",children:[m.jsx(R,{size:13}),ee(ne.views_count)]}),m.jsxs("span",{className:"stat-item",children:[m.jsx(P,{size:13}),ee(Y)]})]}),m.jsxs("div",{className:"action-buttons",children:[m.jsxs("button",{className:"action-btn like-btn "+(I?"active":""),onClick:()=>c(void 0,null,(function*(){if(!t||V)return;const e=I,n=Y;K(!I),$((e=>I?Math.max(0,e-1):e+1)),G(!0);try{const e=yield x.toggleMovieLike(t.movie.id);K(e.liked),$(e.likes_count),t&&(t.user_interactions.has_liked=e.liked,t.movie.likes_count=e.likes_count)}catch(r){K(e),$(n),null==r||r.message}finally{G(!1)}})),disabled:V,children:[m.jsx(P,{size:14,fill:I?"currentColor":"none"}),"Like"]}),m.jsxs("button",{className:"action-btn watchlist-btn "+(B?"active":""),onClick:()=>c(void 0,null,(function*(){if(!t||X)return;const e=B,n=W;J(!B),q((e=>B?Math.max(0,e-1):e+1)),H(!0);try{const e=yield x.toggleMovieWishlist(t.movie.id);J(e.wishlisted),q(e.wishlist_count),t&&(t.user_interactions.has_wishlisted=e.wishlisted,t.movie.wishlist_count=e.wishlist_count)}catch(r){J(e),q(n),null==r||r.message}finally{H(!1)}})),disabled:X,children:[m.jsx(T,{size:14,fill:B?"currentColor":"none"}),"Watchlist"]}),m.jsxs("button",{className:"action-btn share-btn",onClick:()=>{const e=S();navigator.share?navigator.share({title:null==e?void 0:e.title,text:`Watch "${null==e?void 0:e.title}" on UgFlix`,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),Z(!0),setTimeout((()=>Z(!1)),3e3))},children:[m.jsx(_,{size:14}),"Share"]}),m.jsxs("button",{className:"action-btn download-btn",onClick:()=>{const e=S();e&&window.open(e.url,"_blank")},children:[m.jsx(A,{size:14}),"Download"]})]})]})]})]}),m.jsx(f,{lg:4,className:"right-content",children:m.jsxs("div",{className:"related-movies-sidebar",children:[m.jsx("h3",{className:"sidebar-title",children:"Series"===ne.type?"More Episodes":"Related Movies"}),Array.isArray(t.related_movies)&&t.related_movies.length>0?m.jsx("div",{className:"related-movies-list",children:t.related_movies.map((e=>{const t=N(),r=t&&t.id===e.id;return m.jsxs("div",{className:"related-movie-card "+(r?"next-episode":""),onClick:()=>(e=>{n(`/watch/${e.id}`)})(e),children:[r&&m.jsx("div",{className:"next-badge",children:"▶ Up Next"}),m.jsxs("div",{className:"related-movie-thumbnail",children:[m.jsx("img",{src:e.thumbnail_url,alt:e.title,loading:"lazy"}),m.jsx("div",{className:"play-overlay-icon",children:m.jsx(b,{size:20,fill:"white"})})]}),m.jsxs("div",{className:"related-movie-info",children:[m.jsx("h4",{className:"related-movie-title",children:e.title}),m.jsxs("div",{className:"related-movie-meta",children:[m.jsx("span",{className:"meta-type",children:e.type}),e.director&&m.jsxs("span",{className:"meta-vj",title:e.director,children:["VJ ",e.director]}),"Series"===e.type&&e.episode_number&&m.jsxs("span",{className:"meta-episode",children:["Ep ",e.episode_number]}),e.rating&&m.jsxs("span",{className:"meta-rating",children:[m.jsx(T,{size:11,fill:"currentColor"}),e.rating]}),e.duration&&m.jsxs("span",{className:"meta-duration",children:[m.jsx(M,{size:11}),e.duration]})]})]})]},e.id)}))}):m.jsx("div",{className:"no-related",children:m.jsxs("p",{children:["No related ","Series"===ne.type?"episodes":"movies"," available"]})})]})})]})]})}):null};export{I as default};
