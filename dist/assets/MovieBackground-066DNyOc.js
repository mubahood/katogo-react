var e=Object.defineProperty,n=(n,r,t)=>((n,r,t)=>r in n?e(n,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[r]=t)(n,"symbol"!=typeof r?r+"":r,t),r=(e,n,r)=>new Promise(((t,o)=>{var i=e=>{try{s(r.next(e))}catch(n){o(n)}},a=e=>{try{s(r.throw(e))}catch(n){o(n)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,a);s((r=r.apply(e,n)).next())}));import{j as t,S as o}from"./vendor-bootstrap-CDKGkX3Y.js";import{r as i}from"./vendor-react-CSr-5IoM.js";import{A as a}from"./api.config-D25WIGfW.js";import{i as s,U as l,Y as c,X as d,h as u,W as m}from"./index-BzUMVULD.js";import{a as g,N as h}from"./vendor-router-D9z9DFGH.js";const f=new class{constructor(){n(this,"baseUrl",a.BASE_URL)}login(e){return r(this,null,(function*(){var n,r,t,o,i,a;try{const c={email:e.email,password:e.password,platform_type:"web",remember:e.remember||!1},d=yield s("auth/login",c);if(1!==d.code){if(d.errors){const e=Object.values(d.errors).flat();throw new Error(e.join(", "))}throw new Error(d.message||"Login failed")}try{const e=(null==(r=null==(n=d.data)?void 0:n.user)?void 0:r.token)||(null==(o=null==(t=d.data)?void 0:t.user)?void 0:o.remember_token);e&&localStorage.setItem("ugflix_auth_token",e),(null==(i=d.data)?void 0:i.user)&&localStorage.setItem("ugflix_user",JSON.stringify(d.data.user)),(null==(a=d.data)?void 0:a.company)&&localStorage.setItem("ugflix_company",JSON.stringify(d.data.company))}catch(l){}return{success:!0,code:d.code,data:d.data,message:d.message}}catch(c){throw new Error(c.message||"Network error occurred")}}))}register(e){return r(this,null,(function*(){var n,r,t,o,i,a;try{const c={name:e.name,email:e.email,password:e.password,platform_type:"web"},d=yield s("auth/register",c);if(1!==d.code){if(d.errors){const e=Object.values(d.errors).flat();throw new Error(e.join(", "))}throw new Error(d.message||"Registration failed")}try{const e=(null==(r=null==(n=d.data)?void 0:n.user)?void 0:r.token)||(null==(o=null==(t=d.data)?void 0:t.user)?void 0:o.remember_token);e&&localStorage.setItem("ugflix_auth_token",e),(null==(i=d.data)?void 0:i.user)&&localStorage.setItem("ugflix_user",JSON.stringify(d.data.user)),(null==(a=d.data)?void 0:a.company)&&localStorage.setItem("ugflix_company",JSON.stringify(d.data.company))}catch(l){}return{success:!0,code:d.code,data:d.data,message:d.message}}catch(c){throw new Error(c.message||"Network error occurred")}}))}logout(){return r(this,null,(function*(){try{this.getAuthToken()&&(yield s("auth/logout",{platform_type:"web"}))}catch(e){}finally{localStorage.removeItem("ugflix_auth_token"),localStorage.removeItem("ugflix_user"),localStorage.removeItem("ugflix_company")}}))}getAuthToken(){return l.loadFromDatabase(c)}getCurrentUser(){return l.loadFromDatabase(d)}isAuthenticated(){const e=this.getAuthToken(),n=this.getCurrentUser();return!(!e||!n)}verifyEmail(e){return r(this,null,(function*(){try{const n=yield s("auth/verify-email",{token:e});if(1!==n.code)throw new Error(n.message||"Email verification failed");return n}catch(n){throw new Error(n.message||"Network error occurred")}}))}resendVerificationEmail(e){return r(this,null,(function*(){try{const n=yield s("auth/resend-verification",{email:e});if(1!==n.code)throw new Error(n.message||"Failed to resend verification email");return{success:!0,message:n.message}}catch(n){throw new Error(n.message||"Network error occurred")}}))}requestPasswordReset(e){return r(this,null,(function*(){try{const n=yield s("auth/forgot-password",{email:e});if(1!==n.code)throw new Error(n.message||"Failed to send password reset email");return{success:!0,message:n.message}}catch(n){throw new Error(n.message||"Network error occurred")}}))}resetPassword(e,n,t,o){return r(this,null,(function*(){try{const r=yield s("auth/reset-password",{token:e,email:n,password:t,password_confirmation:o});if(1!==r.code){if(r.errors){const e=Object.values(r.errors).flat();throw new Error(e.join(", "))}throw new Error(r.message||"Password reset failed")}return r}catch(r){throw new Error(r.message||"Network error occurred")}}))}refreshToken(){return r(this,null,(function*(){var e,n;try{if(!this.getAuthToken())throw new Error("No auth token available");const r=yield s("auth/refresh",{platform_type:"web"});if(1!==r.code)throw new Error(r.message||"Token refresh failed");return(null==(n=null==(e=r.data)?void 0:e.user)?void 0:n.remember_token)&&(localStorage.setItem("ugflix_auth_token",r.data.user.remember_token),localStorage.setItem("ugflix_user",JSON.stringify(r.data.user)),localStorage.setItem("ugflix_company",JSON.stringify(r.data.company))),r}catch(r){throw localStorage.removeItem("ugflix_auth_token"),localStorage.removeItem("ugflix_user"),localStorage.removeItem("ugflix_company"),new Error(r.message||"Network error occurred")}}))}},p=({children:e,requireAuth:n=!0,redirectTo:a})=>{const s=g(),[l,c]=i.useState(null),[d,u]=i.useState(!0);i.useEffect((()=>{m()}),[]);const m=()=>r(void 0,null,(function*(){try{const r=f.isAuthenticated();if(c(r),r&&n)try{yield f.getCurrentUser()}catch(e){f.logout(),c(!1)}}catch(e){c(!1)}finally{u(!1)}}));if(d)return t.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"100vh"},children:t.jsxs("div",{className:"text-center",children:[t.jsx(o,{animation:"border",variant:"danger"}),t.jsx("p",{className:"mt-3 text-muted",children:"Checking authentication..."})]})});if(n&&!l){const e=a||"/auth/login";return t.jsx(h,{to:e,state:{from:s},replace:!0})}if(!n&&l){const e=a||"/";return t.jsx(h,{to:e,replace:!0})}return t.jsx(t.Fragment,{children:e})},v=({className:e="",showOverlay:n=!0,overlayOpacity:o=.7,showMovieInfo:a=!1,muted:s=!0,showControls:l=!1})=>{const[c,d]=i.useState(null),[g,h]=i.useState(!1),[f,p]=i.useState(!1),[v,b]=i.useState(s);i.useState(!1);const w=i.useRef(null);i.useEffect((()=>{r(void 0,null,(function*(){try{const e=yield u("random-movie");if(1!==e.code||!e.data)throw new Error("Invalid response format");d(e.data)}catch(e){d({id:0,title:`${m.NAME}`,description:"Uganda's premier streaming platform for movies and entertainment.",video_url:"",genre:"Entertainment",type:"Platform",year:(new Date).getFullYear().toString()})}}))}),[]);return i.useEffect((()=>{if((null==c?void 0:c.video_url)&&w.current&&g){(()=>r(void 0,null,(function*(){var e;try{yield null==(e=w.current)?void 0:e.play()}catch(n){}})))()}}),[c,g]),t.jsxs("div",{className:`movie-background-container ${e}`,children:[(null==c?void 0:c.video_url)&&!f&&t.jsx("video",{ref:w,className:"movie-background-video",autoPlay:!0,muted:v,loop:!0,playsInline:!0,onLoadedData:()=>{if(w.current){const e=.1*w.current.duration;w.current.currentTime=e,w.current.play().catch(console.error)}h(!0)},onTimeUpdate:()=>{if(w.current){const e=w.current.currentTime,n=w.current.duration;e>=.3*n&&(w.current.currentTime=.1*n)}},onError:()=>{p(!0)},children:t.jsx("source",{src:c.video_url,type:"video/mp4"})}),(!(null==c?void 0:c.video_url)||f)&&t.jsx("div",{className:"movie-background-fallback",style:{backgroundImage:(null==c?void 0:c.image_url)||(null==c?void 0:c.thumbnail_url)?`url(${c.image_url||c.thumbnail_url})`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}}),n&&t.jsx("div",{className:"movie-background-overlay",style:{background:`linear-gradient(rgba(0,0,0,${.6*o}), rgba(0,0,0,${o}))`}}),(null==c?void 0:c.video_url)&&!f&&t.jsx("button",{onClick:()=>b(!v),className:"movie-background-volume-control visible",title:v?"Unmute video":"Mute video",children:v?"ðŸ”‡":"ðŸ”Š"}),a&&c&&t.jsxs("div",{className:"movie-background-info",children:[t.jsxs("div",{className:"movie-badge",children:[c.type," â€¢ ",c.year," â€¢ ",c.genre]}),t.jsx("h3",{className:"movie-title",children:c.title}),c.description&&t.jsx("p",{className:"movie-description",dangerouslySetInnerHTML:{__html:c.description.length>120?c.description.substring(0,120).trim()+"...":c.description}})]}),(null==c?void 0:c.video_url)&&!g&&!f&&t.jsxs("div",{className:"movie-background-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("span",{children:"Loading movie..."})]}),t.jsx("style",{children:`\n        .movie-background-container {\n          position: relative;\n          width: 100%;\n          height: 100%;\n          overflow: hidden;\n          background: #000;\n        }\n        \n        .movie-background-video {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n          z-index: 1;\n          opacity: ${g?1:0};\n          transition: opacity 1s ease-in-out;\n        }\n        \n        .movie-background-fallback {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background-size: cover;\n          background-position: center;\n          background-repeat: no-repeat;\n          z-index: 1;\n        }\n        \n        .movie-background-overlay {\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          z-index: 2;\n          transition: background 0.5s ease;\n        }\n        \n        .movie-background-volume-control {\n          position: fixed;\n          bottom: 90px;\n          left: 1.5rem;\n          z-index: 900;\n          background: rgba(0,0,0,0.85);\n          border: 2px solid rgba(255,255,255,0.4);\n          border-radius: 50%;\n          width: 50px;\n          height: 50px;\n          color: white;\n          font-size: 1.25rem;\n          cursor: pointer;\n          backdrop-filter: blur(10px);\n          transition: all 0.3s ease;\n          opacity: 1;\n          transform: scale(1);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          box-shadow: 0 4px 15px rgba(0,0,0,0.5);\n        }\n        \n        .movie-background-volume-control:hover {\n          background: rgba(183, 28, 28, 0.9);\n          border-color: rgba(255,255,255,0.8);\n          transform: scale(1.1);\n          box-shadow: 0 6px 20px rgba(183, 28, 28, 0.6);\n        }\n        \n        .movie-background-info {\n          position: absolute;\n          bottom: 2rem;\n          left: 2rem;\n          right: 2rem;\n          z-index: 5;\n          color: white;\n          max-width: 400px;\n        }\n        \n        .movie-badge {\n          display: inline-block;\n          background: rgba(255,255,255,0.15);\n          color: white;\n          padding: 0.3rem 0.8rem;\n          border-radius: 20px;\n          font-size: 0.75rem;\n          font-weight: 600;\n          text-transform: uppercase;\n          letter-spacing: 0.05em;\n          margin-bottom: 0.5rem;\n          backdrop-filter: blur(10px);\n          border: 1px solid rgba(255,255,255,0.2);\n        }\n        \n        .movie-title {\n          font-size: 1.25rem;\n          font-weight: bold;\n          margin-bottom: 0.5rem;\n          text-shadow: 2px 2px 4px rgba(0,0,0,0.8);\n          line-height: 1.2;\n        }\n        \n        .movie-description {\n          font-size: 0.875rem;\n          line-height: 1.4;\n          opacity: 0.9;\n          text-shadow: 1px 1px 2px rgba(0,0,0,0.8);\n          margin: 0;\n        }\n        \n        .movie-background-loading {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          z-index: 5;\n          color: white;\n          text-align: center;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          gap: 1rem;\n        }\n        \n        .loading-spinner {\n          width: 40px;\n          height: 40px;\n          border: 3px solid rgba(255,255,255,0.3);\n          border-top: 3px solid white;\n          border-radius: 50%;\n          animation: spin 1s linear infinite;\n        }\n        \n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        \n        /* Mobile optimizations */\n        @media (max-width: 768px) {\n          .movie-background-info {\n            bottom: 1rem;\n            left: 1rem;\n            right: 1rem;\n          }\n          \n          .movie-background-volume-control {\n            bottom: 90px;\n            left: 1rem;\n            width: 44px;\n            height: 44px;\n            font-size: 1.1rem;\n          }\n          \n          .movie-title {\n            font-size: 1rem;\n          }\n          \n          .movie-description {\n            font-size: 0.8rem;\n          }\n        }\n        \n        /* Ultra small mobile */\n        @media (max-width: 480px) {\n          .movie-background-volume-control {\n            bottom: 85px;\n            left: 0.75rem;\n            width: 40px;\n            height: 40px;\n            font-size: 1rem;\n          }\n          \n          .movie-background-info {\n            bottom: 0.5rem;\n            left: 0.5rem;\n            right: 0.5rem;\n          }\n          \n          .movie-title {\n            font-size: 0.875rem;\n          }\n          \n          .movie-description {\n            font-size: 0.75rem;\n          }\n        }\n        \n        /* High DPI displays */\n        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {\n          .movie-background-video {\n            image-rendering: -webkit-optimize-contrast;\n            image-rendering: crisp-edges;\n          }\n        }\n      `})]})};export{p as A,v as M,f as a};
