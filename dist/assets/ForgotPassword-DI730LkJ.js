var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(s,r,t)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,l=(e,s)=>{for(var r in s||(s={}))a.call(s,r)&&n(e,r,s[r]);if(t)for(var r of t(s))o.call(s,r)&&n(e,r,s[r]);return e},i=(e,t)=>s(e,r(t)),d=(e,s,r)=>new Promise(((t,a)=>{var o=e=>{try{l(r.next(e))}catch(s){a(s)}},n=e=>{try{l(r.throw(e))}catch(s){a(s)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,n);l((r=r.apply(e,s)).next())}));import{j as c,A as m,F as u,B as p,S as g}from"./vendor-bootstrap-CDKGkX3Y.js";import{r as x,R as h}from"./vendor-react-CSr-5IoM.js";import{u as y,L as w}from"./vendor-router-D9z9DFGH.js";import{u as b}from"./vendor-redux-DhM9Zidd.js";import{W as f,a0 as j,a1 as v}from"./index-BzUMVULD.js";import"./vendor-query-BOtKDBw2.js";import"./vendor-ui-C66qigmO.js";const C=()=>{const e=y(),s=b(),[r,t]=x.useState("request"),[a,o]=x.useState(""),[n,C]=x.useState({email:""}),[P,N]=x.useState({email:"",code:"",newPassword:"",confirmPassword:""}),[S,k]=x.useState({}),[T,B]=x.useState(!1),[E,R]=x.useState(""),[z,q]=x.useState("");h.useEffect((()=>(document.body.style.paddingTop="0",()=>{document.body.style.paddingTop="calc(56px + 35px + 0px)"})),[]);const F=e=>{const{name:s,value:t}=e.target;"request"===r?C((e=>i(l({},e),{[s]:t}))):N((e=>i(l({},e),{[s]:t}))),S[s]&&k((e=>i(l({},e),{[s]:void 0}))),E&&R(""),z&&q("")},I={minHeight:"100vh",background:"linear-gradient(135deg, #B71C1C, #8B0000)",display:"flex",margin:0,padding:0},O={flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:"white",padding:"var(--spacing-6)",textAlign:"center",background:"linear-gradient(135deg, #B71C1C 0%, #8B0000 100%)"};return c.jsxs("div",{style:I,children:[c.jsx("div",{style:O,className:"d-none d-lg-flex",children:c.jsxs("div",{children:[c.jsx(w,{to:"/",className:"text-white text-decoration-none mb-4 d-block",children:c.jsx("img",{src:"/media/logos/logo-white.png",alt:f.NAME,style:{maxHeight:"60px",marginBottom:"var(--spacing-lg)"},onError:e=>{e.currentTarget.src="/media/logos/logo.png",e.currentTarget.style.filter="brightness(0) invert(1)"}})}),c.jsx("h1",{style:{fontSize:"var(--font-size-3xl)",fontWeight:"bold",marginBottom:"var(--spacing-lg)",color:"white"},children:"request"===r?"Forgot Password?":"Reset Password"}),c.jsx("p",{style:{fontSize:"var(--font-size-lg)",opacity:.9,marginBottom:"var(--spacing-xl)",lineHeight:1.6},children:"request"===r?"Don't worry! It happens. Please enter your email address and we'll send you a reset code.":"Enter the reset code sent to your email along with your new password."}),c.jsxs("div",{style:{marginTop:"var(--spacing-xl)"},children:[c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-shield-check",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Secure Password Recovery"})]}),c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-envelope",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Email Verification Required"})]}),c.jsxs("div",{style:{marginBottom:"var(--spacing-md)",display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)"},children:[c.jsx("i",{className:"bi bi-clock",style:{fontSize:"var(--font-size-xl)"}}),c.jsx("span",{children:"Quick & Easy Process"})]})]})]})}),c.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",padding:"var(--spacing-5)",backgroundColor:"white",borderRadius:"0",boxShadow:"0 10px 30px rgba(0,0,0,0.1)"},children:c.jsxs("div",{style:{width:"100%",maxWidth:"400px",padding:0},children:[c.jsx("div",{className:"text-center mb-4 d-lg-none",children:c.jsx(w,{to:"/",children:c.jsx("img",{src:"/media/logos/logo.png",alt:f.NAME,style:{maxHeight:"50px"},onError:e=>{e.currentTarget.style.display="none"}})})}),c.jsxs("div",{className:"text-center mb-4",children:[c.jsx("h2",{className:"h3 fw-bold",children:"request"===r?"Forgot Password":"Reset Password"}),c.jsx("p",{className:"text-muted",children:"request"===r?"Enter your email to receive a reset code":`Enter the code sent to ${a}`})]}),E&&c.jsx(m,{variant:"danger",className:"mb-4",children:E}),z&&c.jsx(m,{variant:"success",className:"mb-4",children:z}),"request"===r?c.jsxs(u,{onSubmit:e=>d(void 0,null,(function*(){if(e.preventDefault(),(()=>{const e={};return n.email?/\S+@\S+\.\S+/.test(n.email)||(e.email="Please enter a valid email"):e.email="Email is required",k(e),0===Object.keys(e).length})()){B(!0),k({}),R(""),q("");try{const e=yield s(j(n.email));if(!e.success)throw new Error(e.error||"Failed to send password reset email");q(e.message||"Password reset code sent to your email"),o(n.email),N((e=>i(l({},e),{email:n.email}))),t("reset")}catch(r){const e=(null==r?void 0:r.message)||r||"Failed to send password reset email. Please try again.";R(e)}finally{B(!1)}}})),children:[c.jsxs(u.Group,{className:"mb-3",children:[c.jsx(u.Label,{children:"Email Address"}),c.jsx(u.Control,{type:"email",name:"email",value:n.email,onChange:F,isInvalid:!!S.email,placeholder:"Enter your email address",autoComplete:"email",style:{borderRadius:"0"}}),c.jsx(u.Control.Feedback,{type:"invalid",children:S.email})]}),c.jsx(p,{type:"submit",variant:"primary",size:"lg",className:"w-100 mb-4",disabled:T,style:{backgroundColor:"#B71C1C",borderColor:"rgba(255,255,255,0.2)",border:"2px solid rgba(255,255,255,0.2)",borderRadius:"0",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"600"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#8B0000",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(183, 28, 28, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#B71C1C",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:T?c.jsxs(c.Fragment,{children:[c.jsx(g,{size:"sm",className:"me-2"}),"Sending reset code..."]}):"Send Reset Code"}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Remember your password? "}),c.jsx(w,{to:"/auth/login",className:"text-decoration-none fw-semibold",style:{color:"#B71C1C"},children:"Sign in"})]})]}):c.jsxs(u,{onSubmit:r=>d(void 0,null,(function*(){if(r.preventDefault(),(()=>{const e={};return P.code?P.code.length<3&&(e.code="Please enter a valid reset code"):e.code="Reset code is required",P.newPassword?P.newPassword.length<4&&(e.newPassword="Password must be at least 4 characters"):e.newPassword="Password is required",P.confirmPassword?P.newPassword!==P.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your password",k(e),0===Object.keys(e).length})()){B(!0),k({}),R(""),q("");try{const r=yield s(v(P.email,P.code,P.newPassword));if(!r.success)throw new Error(r.error||"Failed to reset password");q(r.message||"Password reset successfully"),setTimeout((()=>{e("/auth/login")}),2e3)}catch(t){const e=(null==t?void 0:t.message)||t||"Failed to reset password. Please try again.";R(e)}finally{B(!1)}}})),children:[c.jsxs(u.Group,{className:"mb-3",children:[c.jsx(u.Label,{children:"Reset Code"}),c.jsx(u.Control,{type:"text",name:"code",value:P.code,onChange:F,isInvalid:!!S.code,placeholder:"Enter the reset code from your email",style:{borderRadius:"0"}}),c.jsx(u.Control.Feedback,{type:"invalid",children:S.code})]}),c.jsxs(u.Group,{className:"mb-3",children:[c.jsx(u.Label,{children:"New Password"}),c.jsx(u.Control,{type:"password",name:"newPassword",value:P.newPassword,onChange:F,isInvalid:!!S.newPassword,placeholder:"Enter your new password",autoComplete:"new-password",style:{borderRadius:"0"}}),c.jsx(u.Control.Feedback,{type:"invalid",children:S.newPassword})]}),c.jsxs(u.Group,{className:"mb-3",children:[c.jsx(u.Label,{children:"Confirm New Password"}),c.jsx(u.Control,{type:"password",name:"confirmPassword",value:P.confirmPassword,onChange:F,isInvalid:!!S.confirmPassword,placeholder:"Confirm your new password",autoComplete:"new-password",style:{borderRadius:"0"}}),c.jsx(u.Control.Feedback,{type:"invalid",children:S.confirmPassword})]}),c.jsx(p,{type:"submit",variant:"primary",size:"lg",className:"w-100 mb-4",disabled:T,style:{backgroundColor:"#B71C1C",borderColor:"rgba(255,255,255,0.2)",border:"2px solid rgba(255,255,255,0.2)",borderRadius:"0",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"600"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#8B0000",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(183, 28, 28, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#B71C1C",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:T?c.jsxs(c.Fragment,{children:[c.jsx(g,{size:"sm",className:"me-2"}),"Resetting password..."]}):"Reset Password"}),c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Need a new code? "}),c.jsx(w,{to:"#",className:"text-decoration-none fw-semibold",style:{color:"#B71C1C"},onClick:e=>{e.preventDefault(),t("request"),k({}),R(""),q("")},children:"Request again"})]})]}),c.jsx("div",{className:"text-center mt-4",children:c.jsxs(w,{to:"/",className:"text-muted text-decoration-none",style:{fontSize:"var(--font-size-sm)"},children:[c.jsx("i",{className:"bi bi-arrow-left"})," ","Back to Shopping"]})})]})})]})};export{C as default};
